<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <title>Ù„Ø¹Ø¨Ø© Ø§Ù„Ù‚Ø·Ø© ÙˆØ§Ù„Ù†Ø³Ø± - Ù†Ø³Ø®Ø© Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø§Ù„ÙƒØ§Ù…Ù„Ø©</title>
    <style>
        body { margin: 0; overflow: hidden; background: #000; font-family: 'Segoe UI', sans-serif; }
        canvas { display: block; }
        #ui {
            position: absolute; top: 20px; left: 20px;
            color: #fff; background: linear-gradient(45deg, rgba(255,0,150,0.3), rgba(0,204,255,0.3));
            padding: 15px; border-radius: 15px; border: 2px solid #fff;
            box-shadow: 0 0 15px #ff00ff; backdrop-filter: blur(5px);
            font-weight: bold; font-size: 18px;
        }
    </style>
</head>
<body>

    <div id="ui">
        ğŸŒˆ Ø§Ù„Ù…Ø±Ø­Ù„Ø©: <span id="lvl">1</span> / 9<br>
        ğŸ’ Ø§Ù„Ù†Ù‚Ø§Ø·: <span id="score">0</span><br>
        ğŸ Ø§Ù„Ø¬ÙˆØ§Ø¦Ø²: <span id="rem">0</span>
    </div>

    <canvas id="game"></canvas>

    <script>
        const canvas = document.getElementById('game');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        let stage = 1;
        let score = 0;
        let cat = { x: 100, y: 200, w: 50, h: 40, dy: 0, gravity: 0.5, jump: -11 };
        let eagle = { x: canvas.width + 100, y: 100, w: 80, h: 60, speed: 4 };
        let items = [];
        let stars = []; // Ù„Ø®Ù„ÙÙŠØ© Ø§Ù„Ø³Ù…Ø§Ø¡ Ø§Ù„Ù„Ø§Ù…Ø¹Ø©

        // ØªÙˆÙ„ÙŠØ¯ Ù†Ø¬ÙˆÙ… Ù„Ù„Ø®Ù„ÙÙŠØ©
        for(let i=0; i<100; i++) stars.push({x: Math.random()*canvas.width, y: Math.random()*canvas.height, s: Math.random()*2});

        function initStage(n) {
            stage = n;
            items = [];
            eagle.x = canvas.width + 500;
            eagle.speed = 3 + n;
            // ØªÙˆØ²ÙŠØ¹ Ø¬ÙˆØ§Ø¦Ø² Ù…Ù„ÙˆÙ†Ø© Ù…ØªÙˆÙ‡Ø¬Ø©
            for(let i=0; i < (6 + n); i++) {
                items.push({ 
                    x: 200 + Math.random()*(canvas.width-300), 
                    y: 100 + Math.random()*(canvas.height-300), 
                    c: `hsl(${Math.random()*360}, 100%, 50%)`, // Ø£Ù„ÙˆØ§Ù† Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© Ù…Ø´Ø¹Ø©
                    type: Math.random() > 0.8 ? 'coupon' : 'gift'
                });
            }
            document.getElementById('lvl').innerText = stage;
            document.getElementById('rem').innerText = items.length;
        }

        window.addEventListener('keydown', (e) => { if(e.code === 'Space') cat.dy = cat.jump; });
        window.onclick = () => cat.dy = cat.jump;

        function draw() {
            // 1. Ø®Ù„ÙÙŠØ© Ù…Ù„ÙˆÙ†Ø© Ù…ØªØ¯Ø±Ø¬Ø© ØªØªØºÙŠØ± Ø­Ø³Ø¨ Ø§Ù„Ù…Ø±Ø­Ù„Ø©
            let bgGrad = ctx.createLinearGradient(0, 0, 0, canvas.height);
            bgGrad.addColorStop(0, `hsl(${stage * 40}, 70%, 20%)`);
            bgGrad.addColorStop(1, `hsl(${stage * 40 + 100}, 70%, 5%)`);
            ctx.fillStyle = bgGrad;
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Ø±Ø³Ù… Ø§Ù„Ù†Ø¬ÙˆÙ… Ø§Ù„Ù…ØªÙ„Ø£Ù„Ø¦Ø©
            ctx.fillStyle = "white";
            stars.forEach(s => ctx.fillRect(s.x, s.y, s.s, s.s));

            // 2. Ø±Ø³Ù… Ø§Ù„Ù‚Ø·Ø© (ØªØµÙ…ÙŠÙ… Ù…Ù„ÙˆÙ†)
            ctx.save();
            ctx.shadowBlur = 20; ctx.shadowColor = "#fff";
            ctx.fillStyle = "#f0f0f0"; // Ø¬Ø³Ù… Ø§Ù„Ù‚Ø·Ø©
            ctx.beginPath();
            ctx.ellipse(cat.x + 25, cat.y + 20, 25, 20, 0, 0, Math.PI*2);
            ctx.fill();
            ctx.fillStyle = "#ffccff"; // Ø£Ø°Ù†ÙŠ Ø§Ù„Ù‚Ø·Ø©
            ctx.beginPath();
            ctx.moveTo(cat.x+5, cat.y+5); ctx.lineTo(cat.x+15, cat.y-10); ctx.lineTo(cat.x+25, cat.y+5); ctx.fill();
            ctx.restore();

            // 3. Ø±Ø³Ù… Ø§Ù„Ù†Ø³Ø± (Ù…Ù† Ø§Ù„Ù…Ø±Ø­Ù„Ø© 3) - Ù†Ø³Ø± Ù†Ø§Ø±ÙŠ
            if(stage >= 3) {
                eagle.x -= eagle.speed;
                if(eagle.y < cat.y) eagle.y += 1.5; else eagle.y -= 1.5;
                if(eagle.x < -100) eagle.x = canvas.width + 200;

                ctx.fillStyle = "#FF4500"; // Ù„ÙˆÙ† Ù†Ø§Ø±ÙŠ
                ctx.shadowBlur = 15; ctx.shadowColor = "red";
                ctx.beginPath();
                ctx.moveTo(eagle.x, eagle.y);
                ctx.lineTo(eagle.x+80, eagle.y-20); ctx.lineTo(eagle.x+80, eagle.y+40);
                ctx.fill();
                ctx.fillStyle = "yellow"; // Ù…Ù†Ù‚Ø§Ø±
                ctx.fillRect(eagle.x-10, eagle.y+10, 15, 10);
                
                // Ø§ØµØ·Ø¯Ø§Ù…
                if(Math.hypot(cat.x-eagle.x, cat.y-eagle.y) < 40) {
                    alert("Ø§Ù„Ù†Ø³Ø± Ù‡Ø²Ù…Ùƒ! Ø¹Ø¯ Ù„Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰");
                    score = 0; initStage(1);
                }
            }

            // 4. Ø±Ø³Ù… Ø§Ù„Ø¬ÙˆØ§Ø¦Ø² (Ø¯ÙˆØ§Ø¦Ø± Ù…ØªÙˆÙ‡Ø¬Ø© Ù…Ù„ÙˆÙ†Ø©)
            items.forEach((item, i) => {
                ctx.shadowBlur = 15; ctx.shadowColor = item.c;
                ctx.fillStyle = item.c;
                ctx.beginPath();
                ctx.arc(item.x, item.y, 15, 0, Math.PI*2);
                ctx.fill();
                
                // Ø¬Ù…Ø¹ Ø§Ù„Ø¬ÙˆØ§Ø¦Ø²
                if(Math.hypot(cat.x-item.x, cat.y-item.y) < 40) {
                    items.splice(i, 1);
                    score += (item.type === 'coupon' ? 100 : 20);
                    document.getElementById('score').innerText = score;
                    document.getElementById('rem').innerText = items.length;
                    if(items.length === 0) {
                        if(stage < 9) initStage(stage + 1);
                        else alert("Ø£Ù†Øª Ø¨Ø·Ù„ Ø­Ù‚ÙŠÙ‚ÙŠ! Ø£Ù†Ù‡ÙŠØª Ø§Ù„Ù€ 9 Ù…Ø±Ø§Ø­Ù„!");
                    }
                }
            });

            // ØªØ­Ø¯ÙŠØ« Ø­Ø±ÙƒØ© Ø§Ù„Ù‚Ø·Ø©
            cat.dy += cat.gravity;
            cat.y += cat.dy;
            if(cat.y > canvas.height - 50) { cat.y = canvas.height - 50; cat.dy = 0; }
            if(cat.y < 0) cat.y = 0;

            requestAnimationFrame(draw);
        }

        initStage(1);
        draw();
    </script>
</body>
</html>