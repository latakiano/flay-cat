<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø«Ø§Ù„Ø«Ø© - Ø¬Ø¨Ø§Ù„ Ø§Ù„Ù†Ø³ÙˆØ±</title>
    <style>
        body { margin: 0; overflow: hidden; background: #001a33; font-family: sans-serif; touch-action: none; }
        #ui { position: absolute; top: 10px; width: 100%; text-align: center; color: white; z-index: 10; pointer-events: none; }
        #overlay { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: rgba(0,0,0,0.8); display: flex; flex-direction: column; 
            justify-content: center; align-items: center; color: white; z-index: 100; 
        }
        button { padding: 20px 50px; font-size: 25px; cursor: pointer; border-radius: 15px; border: none; background: #e67e22; color: white; font-weight: bold; }
    </style>
</head>
<body>

<div id="ui">
    <h2 style="margin:0;">ğŸ”ï¸ Ø§Ù„Ù…Ø±Ø­Ù„Ø© 3: Ø¬Ø¨Ø§Ù„ Ø§Ù„Ù†Ø³ÙˆØ±</h2>
    <p>Ø§Ù„Ù…Ø³Ø§ÙØ© Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©: <span id="dist">1000</span>m</p>
</div>

<div id="overlay">
    <h1>Ø¬Ø§Ù‡Ø² Ù„Ù…ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù†Ø³Ø±ØŸ ğŸ¦…</h1>
    <button onclick="start()">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± ğŸ¾</button>
</div>

<canvas id="c"></canvas>

<script>
    const cvs = document.getElementById('c');
    const ctx = cvs.getContext('2d');
    const distText = document.getElementById('dist');
    const overlay = document.getElementById('overlay');

    function resize() { cvs.width = window.innerWidth; cvs.height = window.innerHeight; }
    window.addEventListener('resize', resize); resize();

    const imgs = {
        cat: new Image(),
        eagle: new Image(),
        fish: new Image()
    };
    imgs.cat.src = 'https://img.icons8.com/color/96/cat--v1.png';
    imgs.eagle.src = 'https://img.icons8.com/color/150/eagle.png';
    imgs.fish.src = 'https://img.icons8.com/color/48/fish.png';

    let active = false, started = false;
    let p = { x: 100, y: 0, v: 0 }, e = { x: -150, y: 0 }, distance = 1000, obs = [];

    function start() {
        overlay.style.display = 'none';
        p.y = cvs.height / 2;
        e.y = cvs.height / 2;
        distance = 1000;
        obs = [];
        active = true;
        started = false;
    }

    function loop() {
        // Ø§Ù„Ø®Ù„ÙÙŠØ© (Ø³Ù…Ø§Ø¡ Ù„ÙŠÙ„ÙŠØ© Ø¬Ø¨Ù„ÙŠØ©)
        ctx.fillStyle = '#001a33';
        ctx.fillRect(0, 0, cvs.width, cvs.height);

        if (active && started) {
            // Ø§Ù„Ø¬Ø§Ø°Ø¨ÙŠØ© ÙˆØ­Ø±ÙƒØ© Ø§Ù„Ù‚Ø·Ø©
            p.v += 0.45; p.y += p.v;
            distance -= 0.8;

            // Ø°ÙƒØ§Ø¡ Ø§Ù„Ù†Ø³Ø± (ÙŠØ·Ø§Ø±Ø¯ Ù…Ù† Ø§Ù„Ø£Ø¹Ù„Ù‰)
            e.y += (p.y - 80 - e.y) * 0.1; 
            e.x = Math.min(p.x - 110, e.x + 0.2);

            // Ø¥Ù†ØªØ§Ø¬ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© (Ø¨ÙŠØ¶Ø§Ø¡ ÙƒØ§Ù„Ø«Ù„Ø¬)
            if (obs.length === 0 || obs[obs.length-1].x < cvs.width - 350) {
                obs.push({ x: cvs.width, t: Math.random() * (cvs.height - 300) + 50, g: 250 });
            }

            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© ÙˆØ§Ù„ØªØµØ§Ø¯Ù…
            obs.forEach((o, i) => {
                o.x -= 8;
                if(p.x+35 > o.x && p.x+15 < o.x+60 && (p.y+15 < o.t || p.y+35 > o.t+o.g)) { active = false; overlay.style.display='flex'; }
                if(o.x < -60) obs.splice(i, 1);
            });

            // Ø§Ù„Ù…ÙˆØª Ø¹Ù†Ø¯ Ø§Ù„Ø³Ù‚ÙˆØ· Ø£Ùˆ Ù„Ù…Ø³ Ø§Ù„Ù†Ø³Ø±
            if(p.y > cvs.height || p.y < 0 || p.x < e.x + 60) { active = false; overlay.style.display='flex'; }

            distText.innerText = Math.floor(distance);
        }

        // Ø§Ù„Ø±Ø³Ù…
        ctx.drawImage(imgs.eagle, e.x, e.y, 110, 110);
        ctx.fillStyle = "#FFFFFF"; // Ø£Ø¹Ù…Ø¯Ø© Ø¨ÙŠØ¶Ø§Ø¡
        obs.forEach(o => { ctx.fillRect(o.x, 0, 60, o.t); ctx.fillRect(o.x, o.t+o.g, 60, cvs.height); });
        ctx.drawImage(imgs.cat, p.x, p.y, 50, 50);

        requestAnimationFrame(loop);
    }

    window.addEventListener('mousedown', () => { if(active) { started = true; p.v = -8; } });
    window.addEventListener('touchstart', (ev) => { ev.preventDefault(); if(active) { started = true; p.v = -8; } }, {passive: false});

    loop();
</script>
</body>
</html>
